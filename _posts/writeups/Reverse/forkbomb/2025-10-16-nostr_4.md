---
title: "Nostr 4"
date: 2025-10-16
tags: [reverse, writeup]  
categories: [Reverse]
tagline: ""
header:
  overlay_image: /assets/images/IMG_writeups/IMG_Reverse/IMG_forkbomb/forkbomb_logo.jpg
  overlay_filter: 0.5 
  overlay_color: "#fff"
  actions:
    - label: "Lab forkbomb"
      url: "https://rev-kids20.forkbomb.ru/tasks/RE2_nostr100"
classes: wide
---

{% raw %}

Для прохождения лабы нужно получить серийный номер.

- [ELF](https://rev-kids20.forkbomb.ru/files/rev/re2/s4.out)
- [PE](https://rev-kids20.forkbomb.ru/files/rev/re2/s4.exe)

# Solution

Пойду смотреть в статике:

```c
int32_t main(int32_t argc, char** argv, char** envp)
    void* const __return_addr_1 = __return_addr
    int32_t* var_c = &argc
    printf(format: "Enter serial number: ")
    fgets(buf: &Buf, n: 0xb, fp: stdin)
    
    if (Check() == 0)
        PrintError()
    else
        PrintOK()
    return 0
```

Сразу мы можем увидеть, что считывается `11` символов с клавиатуры. Вероятно это длина серийного номера. Гляну функцию `Check`:

```c
int32_t Check()
    if (strlen(&Buf) u<= 5)
        return 0
    
    if (
	    Buf[0] == 'c' &&
		Buf[1][0] == '1' &&
		Buf[2][0] == '4' && 
	    Buf[3][0] == 'a' &&
	    Buf[4][0] == 'e' &&
	    Buf[5][0] == 'B'
    )
        return 1
    
    return 0
```

Ничего сложного. Серийный номер не должен быть меньше 5 символов. А в условии захардкожены нужные значения. Соберу их в единый ключ:

```
c14aeB
```

Сдам его на дашборде:

![IMG](/assets/images/IMG_writeups/IMG_Reverse/IMG_forkbomb/IMG_nostr_4/1.png){: height="200" .align-center}

{% endraw %}