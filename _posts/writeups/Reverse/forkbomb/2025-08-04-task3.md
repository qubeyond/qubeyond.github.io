---
title: "task3"
date: 2025-08-04
tags: [reverse, writeup]  
categories: [Reverse]
tagline: ""
header:
  overlay_image: /assets/images/IMG_writeups/IMG_Reverse/IMG_forkbomb/forkbomb_logo.webp
  overlay_filter: 0.5 
  overlay_color: "#fff"
  actions:
    - label: "Lab forkbomb"
      url: "https://rev-kids20.forkbomb.ru/tasks/RE2_groke200"
classes: wide
---

Надо пройти все проверки, чтобы приложение отобразило флаг.

Бинари:

- [ELF](https://rev-kids20.forkbomb.ru/files/rev/re2/task3)
- [PE](https://rev-kids20.forkbomb.ru/files/rev/re2/task3.exe)

## Solution

Посмотрю инфу о файле:

```bash                                                     
Info:
    File name: /spbctf_rev/task3/task3
    Size: 7628
    File type: ELF32
    String: ELF(386)
    Extension: elf
    Operation system: Ubuntu Linux(16.04.4,ABI: 2.6.32)
    Architecture: 386
    Mode: 32-bit
    Type: EXEC
    Endianness: LE
```

Закидываю бинарь в `Binary Ninja`. Угадайте, что я иду смотреть?) Правильно, функцию `main`)

```c
int32_t main(int32_t argc, char** argv, char** envp) {
    void* const __return_addr_1 = __return_addr
    int32_t* var_c = &argc
    char** argv_1 = argv
    void* gsbase
    int32_t eax_1 = *(gsbase + 0x14)
    FILE* fp = fopen(filename: "Hello1", mode: "r")
    int32_t result
    
    if (fp != 0)
        void buf
        fgets(&buf, n: 0xff, fp)
        fclose(fp)
        FILE* fp_1 = fopen(filename: "Hello2", mode: "r")
        
        if (fp_1 != 0)
            void buf_1
            fgets(buf: &buf_1, n: 0xff, fp: fp_1)
            fclose(fp: fp_1)
            
            if (check(&buf, &buf_1) == 0)
                if (check2(&buf) == 0)
                    printf(format: "Flag{%s}\n", &buf)
                
                result = 0
            else
                puts(str: "Nope")
                result = 1
        else
            puts(str: "NOT AGAIN!")
            result = 3
    else
        puts(str: "NOOOOO")
        result = 5
    
    if (eax_1 == *(gsbase + 0x14))
        return result
    
    __stack_chk_fail()
    noreturn
}
```


